var uploadForm=document.getElementById("upload-form"),deleteSelected=document.getElementById("delete-selected"),inputField=document.getElementById("inputField"),output=document.getElementById("output"),autoScroll=document.getElementById("autoScroll"),cmdHist=[],cmdHistIndex=0;function openTab(e){for(var t,n=document.getElementsByClassName("tab"),d=0;d<n.length;d++)n[d].style.display="none";for(t=document.getElementsByClassName("tab-button"),d=0;d<t.length;d++)t[d].className=t[d].className.replace(" active","");document.getElementById(e).style.display="block",event.currentTarget.className+=" active"}function submitData(){var e=inputField.value;cmdHist.push(e),cmdHistIndex=cmdHist.length,fetch("/submit",{method:"POST",body:e}),inputField.value=""}function clearOutput(){output.innerHTML=""}function poll(){fetch("/poll").then(e=>e.json()).then(e=>{var t=autoScroll.checked&&output.scrollTop+output.clientHeight===output.scrollHeight;e.forEach(e=>{var t=document.createElement("div");t.textContent=""!=e?e:" ",output.appendChild(t)}),t&&(output.scrollTop=output.scrollHeight)})}function fetchAndDisplayFiles(){fetch("/list-files").then(e=>e.json()).then(e=>{const n=document.querySelector("#files-table tbody");n.innerHTML="",e.forEach(e=>{var t=document.createElement("tr");t.innerHTML=`
                    <td><input type="checkbox" class="file-checkbox" data-filename="${e.name}"></td>
                    <td><a href="/download?filename=${encodeURIComponent(e.name)}">${e.name}</a></td>
                    <td>${e.size} bytes</td>
                `,n.appendChild(t)})})}function downloadFile(e){window.open("/download?filename="+encodeURIComponent(e),"_blank")}inputField.addEventListener("keydown",function(e){"Enter"===e.key?submitData():"ArrowUp"===e.key?(cmdHistIndex=Math.max(cmdHistIndex-1,0),inputField.value=cmdHist[cmdHistIndex]||""):"ArrowDown"===e.key&&(cmdHistIndex=Math.min(cmdHistIndex+1,cmdHist.length-1),inputField.value=cmdHist[cmdHistIndex]||"")}),uploadForm.addEventListener("submit",function(e){e.preventDefault();e=new FormData(uploadForm);fetch("/upload",{method:"POST",body:e}).then(e=>{e.ok?fetchAndDisplayFiles():alert("Upload failed")}).catch(e=>console.error("Error:",e))}),deleteSelected.addEventListener("click",()=>{var e=Array.from(document.querySelectorAll(".file-checkbox:checked")).map(e=>e.dataset.filename);0<e.length&&confirm("Are you sure you want to delete the selected files?")&&e.forEach(e=>{fetch("/delete-file",{method:"POST",headers:{"Content-Type":"text/plain"},body:e}).then(()=>fetchAndDisplayFiles())})}),document.addEventListener("DOMContentLoaded",fetchAndDisplayFiles),setInterval(poll,2e3);